
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<<<<<<< HEAD
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!-->
<html class="no-js" lang="en">
<!--<![endif]-->

<head>
    <meta charset="utf-8">
    <title>破狼 Blog</title>
    <meta name="author" content="破 狼"> 
    <meta name="description" content="今天在Angularjs交流群中有位童学问道如何为Angular select的ngOptions像Angularjs的ngRepeat一样加上一个索引$index. 其实对于这个问题来说Angular本身并未提供$index之类的变量供使用。但是也不是说对于这个问题我们就没有解决方案。 &hellip;"> 
    <!-- http://t.co/dKP3o1e -->
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="viewport" content="width=device-width, initial-scale=1"> 
    <link rel="canonical" href="http://greengerong.github.io/blog/page/8">
    <link href="/favicon.png" rel="icon">
    <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
    <link href="/atom.xml" rel="alternate" title="破狼 Blog" type="application/atom+xml">
    <script src="/javascripts/modernizr-2.0.js"></script>
    <script src="//cdn.bootcss.com/jquery/1.9.1/jquery.min.js"></script>
    <script>
    !window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))
    </script>
    <script src="/javascripts/octopress.js" type="text/javascript"></script>
    <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
 
=======
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>破狼 Blog</title>
  <meta name="author" content="破 狼">

  
  <meta name="description" content="&nbsp; 在我们的silverlight项目中，是被打包为xap zip文件下载到客户端，所以silverlight中的app配置文件我们不能直接修改，而在其宿主web host中的web.config在服务端我们也不能直接访问。在我们的项目中遇见了这个问题所以我就有了此博客。 &nbsp;& &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://greengerong.github.io/blog/page/8">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="破狼 Blog" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  


<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fa24b16b917fd5e88f6d6dd10dc673619' type='text/javascript'%3E%3C/script%3E"));
</script>
>>>>>>> 0bab7647fe4f4f5795aed418af9d97aabf2983a0

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">破狼 Blog</a></h1>
  
    <h2>Write less got more.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:greengerong.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
<<<<<<< HEAD
      <h1 class="entry-title"><a href="/blog/2014/02/15/index-for-ng-options/">为Angularjs ngOptions加上index解决方案</a></h1>
=======
      <h1 class="entry-title"><a href="/blog/2011/07/06/Silverlight-huo-qu-WebHost-pei-zhi-xin-xi-WebClient-he-XmlSerializer-mo-ni/">Silverlight获取WebHost配置信息&#8211;WebClient和XmlSerializer模拟</a></h1>
>>>>>>> 0bab7647fe4f4f5795aed418af9d97aabf2983a0
    
    
      <p class="meta">
        








  


<<<<<<< HEAD
<time datetime="2014-02-15T21:43:06+08:00" pubdate data-updated="true">Feb 15<span>th</span>, 2014</time>
=======
<time datetime="2011-07-06T00:00:00+08:00" pubdate data-updated="true"></time>
        
           | <a href="/blog/2011/07/06/Silverlight-huo-qu-WebHost-pei-zhi-xin-xi-WebClient-he-XmlSerializer-mo-ni/#disqus_thread"
             data-disqus-identifier="http://greengerong.github.io/blog/2011/07/06/Silverlight-huo-qu-WebHost-pei-zhi-xin-xi-WebClient-he-XmlSerializer-mo-ni/">Comments</a>
>>>>>>> 0bab7647fe4f4f5795aed418af9d97aabf2983a0
        
      </p>
    
  </header>


<<<<<<< HEAD
  <div class="entry-content"><p>今天在Angularjs交流群中有位童学问道如何为Angular select的ngOptions像Angularjs的ngRepeat一样加上一个索引$index.</p>

<p>其实对于这个问题来说Angular本身并未提供$index之类的变量供使用。但是也不是说对于这个问题我们就没有解决方案。</p>

<p>把这个问题换成角度来看,我们所需要的就是js数组的下标，所以我们如果我们能够在对象上加入下标，使用表达式作为option的label就能解决了。</p>

<p>但是第一印象让我想起的是js数组本来就是一个key/value的对象，只是key为数组下标而已，所以有了如下之设计：</p>

<p>html:</p>

<pre class='green'><code>  &lt;pre&gt;&lt;/pre&gt;

  &lt;select  ng-model="a" ng-options="value.field as getDesc1(key,value) for (key,value) in t"&gt;&lt;/select&gt;
</code></pre>

<p>  js:</p>

<pre class='green'><code>$scope.getDesc1 = function(key, value) {
    return (parseInt(key, 10) + 1) + "-&gt;" + value.field;
};
</code></pre>

<p>可是不幸的是如果对于JavaScript你若将他作为key/value对象那么key将是无序的所以，出现了无序的下标如下：</p>

<pre class='green'><code>&lt;select ng-model="a" ng-options="l.field as getDesc1(key,value) for (key,value) in t " class="ng-valid ng-dirty"&gt;
  &lt;option value="0"  &gt;1-&amp;gt;jw_companyTalent&lt;/option&gt;
  &lt;option value="1"  &gt;2-&amp;gt;jw_reportgroup&lt;/option&gt;
  &lt;option value="10" &gt;11-&amp;gt;jw_ads&lt;/option&gt;
  &lt;option value="11" &gt;12-&amp;gt;jw_jobcomment&lt;/option&gt;
  &lt;option value="12" &gt;13-&amp;gt;jw_companyInfo&lt;/option&gt;
  ....
&lt;/select&gt;
</code></pre>

<p>所以这样是无法解决的。还好博主还有一招，ngOptions支持Angularjs的filter，所以我们可以对数据源对象上加上一个order字段标示下标作为序号。并且你可以在一个2年前的Angular的issue中看到Angular已经fix issue，option会对数组进行按下标顺序生成。</p>

<p>html:</p>

<pre class='green'><code>&lt;pre&gt;&lt;/pre&gt;

&lt;select  ng-model="b" ng-options="l.field as getDesc(l) for l in t | index "&gt;&lt;/select&gt;
</code></pre>

<p>js:</p>

<pre class='green'><code>    var app = angular.module('plunker', []);

    app.controller('MainCtrl', function($scope) {
      $scope.t = [{
        "field": "jw_companyTalent"
      }, {
        "field": "jw_reportgroup"
      }];
      $scope.getDesc = function(l) {
        return l.order + "-&gt;" + l.field;
      };
    }).filter("index", [
      function() {
        return function(array) {
          return (array || []).map(function(item, index) {
            item.order = index + 1;
            return item;
          });
        };
      }
    ]);
</code></pre>

<p>这下option是按照有序的生成，最后我们终于能完美解决了,所以本文也将收尾。在最后在附上可运行的demo<a href="http://plnkr.co/edit/tRxzOT?p=preview">plnkr ngOptions index</a>;</p>
=======
  <div class="entry-content"><p>&nbsp; 在我们的silverlight项目中，是被打包为xap zip文件下载到客户端，所以silverlight中的app配置文件我们不能直接修改，而在其宿主web host中的web.config在服务端我们也不能直接访问。在我们的项目中遇见了这个问题所以我就有了此博客。</p>

<p>&nbsp;&nbsp; 先说明解决这个问题的方案有：</p>

<p>1：调用wcf，webservice，Asp.net页面等服务端数据源，异步显示在我们的UI。</p>

<p>2：利用silverlight项目的宿主页面 object，传入初始化参数，在silverlight app中获取。</p>

<p>上面的方案都是针对于我们的少量有限配置信息的获取。我这里做的是利用在服务端的xml配置文件来模拟配置文件（为什么不用web.config？以为存在权限信息的问题，所以我觉得尽量避免此文件信息暴露）。在silverlight的异步加载xml文档并解析xml文档。形成配置信息。</p>

<p>为了全局使用，早些加载xml文档，我们需要在app中加一句：</p>

<p>SLConfigManager.Current.ConfigPath = &ldquo;../SlConfig.xml&rdquo;;//配置文件的路径，相对于我们的xap文件路径。</p>

<p>我们先看一下测试xml：</p>

<pre><code>  &lt;?xml version="1.0" encoding="utf-8" ?&gt; 
&lt;Configuration&gt; 
  &lt;appSettings&gt; 
    &lt;add key="test1" value="123"&gt;&lt;/add&gt; 
    &lt;add key="test2" value="1"&gt;&lt;/add&gt; 
  &lt;/appSettings&gt; 
  &lt;Class ClassID="111"&gt; 
    &lt;Student Age="123"&gt; 
      &lt;Name&gt;ddddd&lt;/Name&gt;     
    &lt;/Student&gt; 
    &lt;Student  Age="28"&gt; 
      &lt;Name&gt;111&lt;/Name&gt;     
    &lt;/Student&gt; 
  &lt;/Class&gt; 
&lt;/Configuration&gt;
</code></pre>

<p>这是我们可以使用：</p>

<pre><code>void Page1_Loaded(object sender, RoutedEventArgs e) 
     { 
         MessageBox.Show(SLConfigManager.Current.GetSection&lt;Class&gt;("Class").ClassID + ""); 
         MessageBox.Show(SLConfigManager.Current.GetAppSettings("test1").ToString()); 
         MessageBox.Show(SLConfigManager.Current.GetAppSettings&lt;Sex&gt;("test2").ToString()); 
     } 

        public enum Sex 
     { 
      man,woman 
     }
</code></pre>

<p>在这里我们模拟了AppSettings，和Section（注：这里的section，不需要预申明，在利用xml转化形成的，更利于我们的配置扩展性，使用到了XmlRoot，XmlElement等attribute），在看看我们的Class类：</p>

<pre><code>using System.Xml.Serialization; 
</code></pre>

<p>  namespace SilverlightApplication2
  {</p>

<pre><code>  [XmlRoot("Student")] 
  public class Student 
  { 
      [XmlElement("Name")] 
      public string Name 
      { get; set; } 

      [XmlAttribute("Age")] 
      public int Age 
      { 
          get; 
          set; 
      } 
  } 

  [XmlRoot("Class")] 
  public class Class 
  { 
      [XmlAttribute("ClassID")] 
      public int ClassID 
      { 
          get; 
          set; 
      } 

      [XmlArray()] 
      [XmlArrayItem("Students")] 
      public System.Collections.Generic.List&lt;Student&gt; Students 
      { 
          get; 
          set; 
      } 
  } 
</code></pre>

<p>  }</p>

<p>最后需要说明的是：在于我们的项目中可能存在xml文件还没有加载，的情况，所以加入了时间支持和IsLoaded属性标示。</p>

<p>源码：</p>

<pre><code>using System; 
using System.Net; 
using System.Windows; 
using System.Windows.Controls; 
using System.Windows.Documents; 
using System.Windows.Ink; 
using System.Windows.Input; 
using System.Windows.Media; 
using System.Windows.Media.Animation; 
using System.Windows.Shapes; 
using System.Xml; 
using System.Xml.Linq; 
using System.Linq; 
using System.Collections.Generic; 
using Green.Utility.Utils; 

namespace SilverlightApplication2 
{ 
    public delegate void LoadComplete(); 

    public class SLConfigManager 
    { 
        private XDocument document = null; 

        private static readonly SLConfigManager _SLConfigManager = new SLConfigManager(); 
        private Dictionary&lt;string, object&gt; dict = new Dictionary&lt;string, object&gt;(); 
        private Dictionary&lt;string, string&gt; appSettings = new Dictionary&lt;string, string&gt;(); 
        private string _ConfigPath = null; 

        public static SLConfigManager Current 
        { 
            get 
            { 
                return _SLConfigManager; 
            } 
        } 

        public string ConfigPath 
        { 
            get { return _ConfigPath; } 
            set 
            { 
                if (_ConfigPath != value) 
                { 
                    _ConfigPath = value; 
                    LoadResource(); 
                } 
            } 
        } 

        public bool IsLoaded 
        { 
            get; 
            private set; 
        } 
        public event LoadComplete LoadComplete; 

        public void EnsureLoadResource() 
        { 

            if (document == null) 
            { 
                LoadResource(); 
            } 
        } 

        protected virtual void LoadResource() 
        { 
            if (string.IsNullOrEmpty(ConfigPath)) 
            { 
                throw new Exception("ConfigPath is required!"); 
            } 

            dict.Clear(); 
            Uri url = new Uri(Application.Current.Host.Source, ConfigPath); 
            WebClient client = new WebClient(); 
            client.OpenReadCompleted += new OpenReadCompletedEventHandler(client_OpenReadCompleted); 
            client.OpenReadAsync(url, client); 
        } 

        protected virtual void client_OpenReadCompleted(object sender, OpenReadCompletedEventArgs e) 
        { 
            if (e.Error != null) 
            { 
                throw e.Error; 
            } 

            var sw = new System.IO.StreamReader(e.Result); 
            var xml = sw.ReadToEnd(); 
            document = XDocument.Parse(xml); 
            sw.Close(); 
            e.Result.Close(); 
            sw = null; 

            GetappSettings(); 

            IsLoaded = true; 
            if (LoadComplete != null) 
            { 
                LoadComplete(); 
            } 
        } 

        protected virtual void GetappSettings() 
        { 
            if (document != null) 
            { 
                var appSettingsel = document.Root.Element("appSettings"); 
                if (appSettings != null) 
                { 
                    appSettingsel.Elements("add").ToList().ForEach(e =&gt; 
                    { 
                        var key = e.Attribute("key").Value; 
                        var value = e.Attribute("value").Value; 
                        if (!string.IsNullOrEmpty(key)&amp;&amp;!this.appSettings.ContainsKey(key)) 
                        { 
                            this.appSettings.Add(key, value); 
                        } 
                    }); 
                } 
            } 
        } 

        public T GetSection&lt;T&gt;(string section) where T : class ,new() 
        { 
            if (document == null) 
            { 
                // throw new Exception("Config Document is null!");                
            } 
            if (!dict.ContainsKey(section)) 
            { 
                var el = document.Root.Descendants().SingleOrDefault(t =&gt; t.Name == section); 
                var xml = el.ToString(); 
                dict.Add(section, XmlSerializer&lt;T&gt;(xml)); 
            } 
            return dict[section] as T; 
        } 

        protected virtual T XmlSerializer&lt;T&gt;(string xml) where T : class ,new() 
        { 
            System.Xml.Serialization.XmlSerializer serialzer = new System.Xml.Serialization.XmlSerializer(typeof(T)); 
            System.IO.MemoryStream ms = new System.IO.MemoryStream(System.Text.Encoding.UTF8.GetBytes(xml)); 
            var obj = serialzer.Deserialize(ms) as T; 
            ms.Flush(); 
            ms.Close(); 
            ms = null; 
            return obj; 
        } 

        public T GetAppSettings&lt;T&gt;(string key) where T : IConvertible 
        { 
            if (appSettings.ContainsKey(key)) 
            { 
                var val = this.appSettings[key]; 
                if (string.IsNullOrEmpty(val)) 
                    return default(T); 
                if (typeof(T).IsEnum) 
                { 
                    return (T)Enum.Parse(typeof(T), val, true); 
                } 
                return (T)Convert.ChangeType(val, typeof(T), null); 
            } 
            return default(T); 
        } 

        public string GetAppSettings(string key) 
        { 
            return GetAppSettings&lt;string&gt;(key); 
        } 
    } 
}
</code></pre>

<p>最后附：<a href="http://files.cnblogs.com/whitewolf/SilverlightApplication2.rar" title="测试程序打包下载">测试程序打包下载</a></p>

<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;本文通过程序<a href="https://github.com/greengerong/cnblogs-blogs2markdown" title="cnblogs-blogs2markdown">cnblogs-blogs2markdown</a>转换的,如质量有问题<a href="http://www.cnblogs.com/whitewolf/archive/2011/07/06/SlConfig.html" title="原文首发">原文首发请看这里</a></p>
>>>>>>> 0bab7647fe4f4f5795aed418af9d97aabf2983a0
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
<<<<<<< HEAD
      <h1 class="entry-title"><a href="/blog/2014/02/11/angular-ngclick-stoppropagation/">Angular ngClick阻止冒泡,默认行为</a></h1>
=======
      <h1 class="entry-title"><a href="/blog/2011/05/14/hun-he-mo-shi-cheng-xu-ji-shi-zhen-dui-V2-050727-ban-ben-sheng-cheng-di-zai-mei-you-pei-zhi-xin-xi-qing-kuang-xia-wu-fa-zai-4-0-yun-hang-shi-jia-zi-cheng-xu-ji/">混合模式程序集是针对“V2.050727”版本生成的，在没有配置信息情况下，无发在4.0运行时架子程序集。</a></h1>
>>>>>>> 0bab7647fe4f4f5795aed418af9d97aabf2983a0
    
    
      <p class="meta">
        








  


<<<<<<< HEAD
<time datetime="2014-02-11T22:27:29+08:00" pubdate data-updated="true">Feb 11<span>th</span>, 2014</time>
=======
<time datetime="2011-05-14T00:00:00+08:00" pubdate data-updated="true"></time>
        
           | <a href="/blog/2011/05/14/hun-he-mo-shi-cheng-xu-ji-shi-zhen-dui-V2-050727-ban-ben-sheng-cheng-di-zai-mei-you-pei-zhi-xin-xi-qing-kuang-xia-wu-fa-zai-4-0-yun-hang-shi-jia-zi-cheng-xu-ji/#disqus_thread"
             data-disqus-identifier="http://greengerong.github.io/blog/2011/05/14/hun-he-mo-shi-cheng-xu-ji-shi-zhen-dui-V2-050727-ban-ben-sheng-cheng-di-zai-mei-you-pei-zhi-xin-xi-qing-kuang-xia-wu-fa-zai-4-0-yun-hang-shi-jia-zi-cheng-xu-ji/">Comments</a>
>>>>>>> 0bab7647fe4f4f5795aed418af9d97aabf2983a0
        
      </p>
    
  </header>


<<<<<<< HEAD
  <div class="entry-content"><p>这其实是一个很简单的问题，如果你认真查看过Angular官方的API文档，本来不想记录的。但是这个问题不止一次的被人问起，所以今天在记录在这里。</p>

<p>在Angular中已经对一些ng事件如ngClick,ngBlur,ngCopy,ngCut,ngDblclick&hellip;中加入了一个变量叫做$event.</p>

<p>如ngClick在官方文档是这么描述的：</p>

<pre class='green'><code>Expression to evaluate upon click. (Event object is available as $event)
</code></pre>

<p>在查看Angular代码<a href="https://github.com/angular/angular.js/blob/a68624444afcb9e3796b1a751cf3817cafd20240/src/ng/directive/ngEventDirs.js">ngEventDirs.js</a>:</p>

<pre class='green'><code>    var ngEventDirectives = {};
    forEach(
      'click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup keypress submit focus blur copy cut paste'.split(' '),
      function(name) {
        var directiveName = directiveNormalize('ng-' + name);
        ngEventDirectives[directiveName] = ['$parse', function($parse) {
          return {
            compile: function($element, attr) {
              var fn = $parse(attr[directiveName]);
              return function(scope, element, attr) {
                element.on(lowercase(name), function(event) {
                  scope.$apply(function() {
                    fn(scope, {$event:event});
                  });
                });
              };
            }
          };
        }];
      }
    );
</code></pre>

<p>在上边代码我们可以得到两个信息：</p>

<ol>
<li>Angular支持的event： click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup keypress submit focus blur copy cut paste</li>
<li>Angular在执行事件函数时候传入了一个名叫$event的常量，该常量即代表当前event对象，如果你在Angular之前引入了jQuery那么这就是jQuery的event.</li>
</ol>


<p>所以我们可以利用event的stopPropagation来阻止事件的冒泡：如下代码：<a href="http://jsbin.com/delow/3/watch?html,js,output">jsbin</a></p>

<p>html 代码</p>

<pre class='green'><code>    &lt;!DOCTYPE html&gt;
    &lt;html id="ng-app" ng-app="app"&gt;
    &lt;head&gt;
    &lt;script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.1.5/angular.min.js"&gt;&lt;/script&gt;
      &lt;meta charset="utf-8"&gt;
      &lt;title&gt;JS Bin&lt;/title&gt;
    &lt;/head&gt;
    &lt;body ng-controller="demo as d"&gt;
       &lt;div ng-click="d.click('parent',$event)"&gt;
         given some text for click
         &lt;hr&gt;
         &lt;input type="checkbox" ng-model="d.stopPropagation" /&gt;Stop Propagation ?
         &lt;hr&gt;
         &lt;button type="button" ng-click="d.click('button',$event)"&gt;button&lt;/button&gt;

       &lt;/div&gt;
    &lt;/body&gt;
    &lt;/html&gt;             
</code></pre>

<p>js 代码</p>

<pre class='green'><code>angular.module("app",[])
.controller("demo",[function(){
  var vm = this;

  vm.click = function(name,$event){
    console.log(name +" -----called");
    if(vm.stopPropagation){
      $event.stopPropagation();
    }
  };

  return vm;
}]);
</code></pre>

<p>可以在<a href="http://jsbin.com/delow/3/watch?html,js,output">jsbin</a>查看效果。</p>

<p>首先打开你的控制台，然在没选中Stop Propagation的情况下点击button你将会看见两条log记录，相反选中后则只会出现button的log信息。</p>

<p>希望大家已经明白了，不要再问这类问题了。</p>
=======
  <div class="entry-content"><p>&nbsp; 混合模式程序集是针对&#8220;V2.050727&#8221;版本生成的，在没有配置信息情况下，无法子啊4.0运行时架子程序集。</p>

<p>&nbsp;</p>

<p><img src="http://images.cnblogs.com/cnblogs_com/whitewolf/MixedRUntime1.jpg" alt="" /></p>

<p>&nbsp;&nbsp;&nbsp;我的做法是在文件中加如app.config，加入：</p>

<p><font color="#ff0000">&nbsp;&lt;startup useLegacyV2RuntimeActivationPolicy=&ldquo;true&rdquo;&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;supportedRuntime version=&ldquo;v4.0&rdquo; /&gt;&nbsp;&nbsp;&nbsp;
&nbsp; &lt;/startup&gt; </font></p>

<p>&nbsp;参考原文：</p>

<p>Mixed mode assembly is built against version &lsquo;v2.0.50727&rsquo; error using .NET 4 Development Web Server</p>

<p>If your application has a dependency on an assembly built in .NET 2 you will see the error below if you try to run your application when it has been built in.NET 4.</p>

<p><em><strong>Mixed mode assembly is built against version &lsquo;v2.0.50727&rsquo; of the runtime and cannot be loaded in the 4.0 runtime without additional configuration information.</strong></em></p>

<p>This can be important in VS2010 testing, as test projects must be built as .NET 4, there is no option to build with an older runtime. I suffered this problem when trying to do some development where I hosted a <a href="http://blogs.blackmarble.co.uk/blogs/rfennell/archive/2010/03/25/a-fix-to-run-typemock-isolator-inside-the-page-load-for-an-aspx-page-on-vs2010-net4.aspx">webpart that make calls into SharePoint (that was faked out with Typemock Isolator) inside a ASP.NET 4.0 test harness</a></p>

<p>The answer to this problem is well documented, you need to add the <strong>useLegacyV2RuntimeActivationPolicy</strong> attribute to a .CONFIG file, but which one? It is not the <strong>web.config</strong> file you might suspect, but the <strong>C:\Program Files (x86)\Common Files\microsoft shared\DevServer\10.0\WebDev.WebServer40.exe.config</strong> file. The revised config file should read as follows (new bits in <font color="#ff0000">red</font>)</p>

<blockquote><p>&lt;?xml version=&ldquo;1.0&rdquo; encoding=&ldquo;utf-8&rdquo; ?&gt;
&lt;configuration&gt;
&nbsp;<font color="#ff0000"> &lt;startup useLegacyV2RuntimeActivationPolicy=&ldquo;true&rdquo;&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;supportedRuntime version=&ldquo;v4.0&rdquo; /&gt;&nbsp;&nbsp;&nbsp;
&nbsp; &lt;/startup&gt; </font></p>

<p>&nbsp; &lt;runtime&gt;
&nbsp;&nbsp;&nbsp; &lt;generatePublisherEvidence enabled=&ldquo;false&rdquo; /&gt;
&nbsp; &lt;/runtime&gt;
&lt;/configuration&gt;</p></blockquote>

<p>Note: Don&#8217;t add the following _&lt;supportedRuntime version=&ldquo;v2.0.50727&rdquo; /&gt;&nbsp; this cause the web server to crash on start-up. _</p>

<p>&nbsp;</p>

<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;本文通过程序<a href="https://github.com/greengerong/cnblogs-blogs2markdown" title="cnblogs-blogs2markdown">cnblogs-blogs2markdown</a>转换的,如质量有问题<a href="http://www.cnblogs.com/whitewolf/archive/2011/05/14/2046449.html" title="原文首发">原文首发请看这里</a></p>
>>>>>>> 0bab7647fe4f4f5795aed418af9d97aabf2983a0
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
<<<<<<< HEAD
      <h1 class="entry-title"><a href="/blog/2013/12/27/angular-ngcloak-new/">ngCloak 实现 Angular 初始化闪烁最佳实践</a></h1>
=======
      <h1 class="entry-title"><a href="/blog/2011/03/27/PD-she-ji-zhong-biao-ming-guo-chang-zi-dong-sheng-cheng-di-zhu-wai-jian-ming-jie-qu-di-wen-ti/">PD设计中表名过长，自动生成的主外键名截取的问题</a></h1>
>>>>>>> 0bab7647fe4f4f5795aed418af9d97aabf2983a0
    
    
      <p class="meta">
        








  


<<<<<<< HEAD
<time datetime="2013-12-27T00:00:00+08:00" pubdate data-updated="true"></time>
=======
<time datetime="2011-03-27T00:00:00+08:00" pubdate data-updated="true"></time>
        
           | <a href="/blog/2011/03/27/PD-she-ji-zhong-biao-ming-guo-chang-zi-dong-sheng-cheng-di-zhu-wai-jian-ming-jie-qu-di-wen-ti/#disqus_thread"
             data-disqus-identifier="http://greengerong.github.io/blog/2011/03/27/PD-she-ji-zhong-biao-ming-guo-chang-zi-dong-sheng-cheng-di-zhu-wai-jian-ming-jie-qu-di-wen-ti/">Comments</a>
>>>>>>> 0bab7647fe4f4f5795aed418af9d97aabf2983a0
        
      </p>
    
  </header>


<<<<<<< HEAD
  <div class="entry-content"><p>在做angular的SPA开发时，我们经常会遇见在如Chrome这类能够快速解析的浏览器上出现表达式( {{ express }}  ),或者是模块(div)的闪烁。对于这个问题由于JavaScript去操作DOM，都会等待DOM加载完成（DOM ready）。对于angular会在DOM ready完会才回去解析html view Template，所以对于Chrome这类快速的浏览器你会看见有闪烁的情况出现。而对于IE7，8这类解析稍慢的浏览器大部分情况下是不会出现这个问题的。</p>

<p>在angular中为我们提供了ng-cloak来实现纺织闪烁的方案，我们只需要在需要的地方加上ng-cloak。同时对于bing文字({{ express }} )我们也可以改为ng-bind来实现避免。</p>

<pre class='green'><code> &lt;div id="template1" ng-cloak&gt;hello&lt;/div&gt;
 &lt;div id="template2" ng-cloak class="ng-cloak"&gt; {{ 'hello IE7' }}  &lt;/div&gt;
 &lt;div id="template2" ng-bing="'hello IE7'"&gt;&lt;/div&gt;
</code></pre>

<p>angular将ng-cloak实现为一个directive，并会在初始化的时候在DOM的heade增加一行css代码，如下：</p>

<pre class='green'><code>&lt;style type="text/css"&gt;@charset "UTF-8";[ng\:cloak],[ng-cloak],[data-ng-cloak],[x-ng-cloak],.ng-cloak,.x-ng-cloak,.ng-hide{display:none !important;}ng\:form{display:block;}.ng-animate-start{clip:rect(0,auto,auto,0);-ms-zoom:1.0001;}.ng-animate-active{clip:rect(-1px,auto,auto,0);-ms-zoom:1;}
&lt;/style&gt;
</code></pre>

<p>从上面我们可以看见angular将带有ng-clock的的元素设置为display:none，隐藏掉，在等到angular解析到带有ng-clock的节点时候，会把attribute和class同时remove掉，这样就可以实现防止节点的闪烁。</p>

<pre class='green'><code>var ngCloakDirective = ngDirective({
      compile: function(element, attr) {
        attr.$set('ngCloak', undefined);
        element.removeClass('ng-cloak');
      }
});
</code></pre>

<p>在angular.js的最后一段代码中能看见前面所说的增加css的代码：</p>

<pre class='green'><code>!angular.$$csp() &amp;&amp; angular.element(document).find('head').prepend('&lt;style type="text/css"&gt;@charset "UTF-8";[ng\\:cloak],[ng-cloak],[data-ng-cloak],[x-ng-cloak],.ng-cloak,.x-ng-cloak,.ng-hide{display:none !important;}ng\\:form{display:block;}.ng-animate-block-transitions{transition:0s all!important;-webkit-transition:0s all!important;}&lt;/style&gt;');
</code></pre>

<p>好像闪烁的问题好像已经能够被我解决了，恩是否是这样的，理论也改如此，但是现实是残酷的，我们的感性认识经常会被现实一记重重的耳光，我们才能很更深入全面的思考，如果浏览器的速度比angular在head中加入css的速度还快呢？我在给公司的一个项目组解决这个闪烁的问题的时候就遇见了这个问题。怎么办呢？那我们只能使出我们必杀技，自己把css加入我们的css文件引入heade，启动加载，ok这样就可以完美解决了。(如果你也遇见了加了ng-cloak还不起作用的话，那么试试直接引入css文件吧)</p>

<p>到这里关于ng-cloak的原理和解决方案已经完成，欢迎继续关注angular的后续经验篇分享。</p>
=======
  <div class="entry-content"><p>在PowerDesinger中，若表名过长，自动生成的主键名会被自动截取。</p>

<p>解决如下：DataBase/Edit Current DBMS/Scripts/Objects/PKey/ConstName中找到Value的值，
默认是 <span style="color: red">PK<em>%.U27:TABLE%</span>，<span style="color: red">U27</span>表示截取27个字符。改成PK</em>%TABLE%主键名就不会被截取了。</p>

<p>其他键同理：找到相应的ConstName Value去掉U.\d:</p>

<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;本文通过程序<a href="https://github.com/greengerong/cnblogs-blogs2markdown" title="cnblogs-blogs2markdown">cnblogs-blogs2markdown</a>转换的,如质量有问题<a href="http://www.cnblogs.com/whitewolf/archive/2011/03/27/1996786.html" title="原文首发">原文首发请看这里</a></p>
>>>>>>> 0bab7647fe4f4f5795aed418af9d97aabf2983a0
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
<<<<<<< HEAD
      <h1 class="entry-title"><a href="/blog/2013/12/24/angular-controller-as-syntax-vs-scope/">Angular Controller as Syntax vs Scope</a></h1>
=======
      <h1 class="entry-title"><a href="/blog/2011/03/26/Excel-huo-bi-zhong-wen-da-xie-han-zi-zhuan-hua/">Excel 货币中文大写汉字转化</a></h1>
>>>>>>> 0bab7647fe4f4f5795aed418af9d97aabf2983a0
    
    
      <p class="meta">
        








  


<<<<<<< HEAD
<time datetime="2013-12-24T00:00:00+08:00" pubdate data-updated="true"></time>
=======
<time datetime="2011-03-26T00:00:00+08:00" pubdate data-updated="true"></time>
        
           | <a href="/blog/2011/03/26/Excel-huo-bi-zhong-wen-da-xie-han-zi-zhuan-hua/#disqus_thread"
             data-disqus-identifier="http://greengerong.github.io/blog/2011/03/26/Excel-huo-bi-zhong-wen-da-xie-han-zi-zhuan-hua/">Comments</a>
>>>>>>> 0bab7647fe4f4f5795aed418af9d97aabf2983a0
        
      </p>
    
  </header>


<<<<<<< HEAD
  <div class="entry-content"><p>今天要和大家分享的是angular从1.2版本开始带来了新语法Controller as。再次之前我们对于angular在view上的绑定都必须使用直接的scope对象，对于controller来说我们也得必须注入$scope这个service。如下：</p>

<pre class='green'><code>angular.module("app",[])
.controller("demoController",["$scope",function($scope){
    $scope.title = "angualr";
 }])

&lt;div ng-app="app" ng-controller="demoController"&gt;
    hello : {{title}} !
&lt;/div&gt;
</code></pre>

<p>有些人觉得即使这样我们的controller还是不够POJO，以及对于coffescript爱好者不足够友好，所以在angular在1.2给我带来了一个新的语法糖这就是本文将要说的controller as的语法糖，修改上面的demo将会变成：</p>

<pre class='green'><code>angular.module("app",[])
.controller("demoController",[function(){
    this.title = "angualr";
}])

&lt;div ng-app="app" ng-controller="demoController as demo"&gt;
     hello : {{demo.title}} !
&lt;/div&gt;
</code></pre>

<p>这里我们可以看见现在controller不再有$scope的注入了，感觉controller就是一个很简单的平面的JavaScript对象了，不存在任何的差别了。再则就是view上多增加了个demoController as demo，给controller起了一个别名，在此后的view模板中靠这个别名来访问数据对象。</p>

<p>或许看到这里你会问为什么需要如此啊，不就是个语法糖而已，先别着急，我们会在后边分析$scope和他的差别。在此之前我们先来看看angular源码的实现这样才会有助于我们的分析：</p>

<p>下面是一段来自angular的code：在1499行开始(行数只能保证在写作的时候有效)</p>

<pre class='green'><code>  if (directive.controllerAs) {
          locals.$scope[directive.controllerAs] = controllerInstance;
   }
</code></pre>

<p>如果你希望看更完全的code请猛击这里<a href="https://github.com/angular/angular.js/blob/c7a1d1ab0b663edffc1ac7b54deea847e372468d/src/ng/compile.js">https://github.com/angular/angular.js/blob/c7a1d1ab0b663edffc1ac7b54deea847e372468d/src/ng/compile.js</a>.</p>

<p>从上面的代码我们能看见的是：angular只是把controller这个对象实例以其as的别名在scope上创建了一个新的对象属性。靠，就这么一行代码搞定！</p>

<p>先别急，既然是语法糖，那么它肯定有他出现的原因，让我们来和直接用$scope对比下：</p>

<p>在此文之前我在angularjs的群中和大家讨论了下我的看法，得到大家不错的反馈，所以有了本文，记录和分享下来。</p>

<p>我规定对于controller as的写法如下：</p>

<pre class='green'><code>angular.module("app",[])
 .controller("demoController",[function(){
        var vm = this;

        vm.title = "angualr";

        return vm;
 }])
</code></pre>

<p>其优势为：</p>

<ol>
<li>定义vm这样会让我们更好的避免JavaScript的this的坑。</li>
<li>如果某个版本的angular不再支持controller as,可以轻易的注入$scope,修改为 var vm = $scope;</li>
<li>因为不再注入$scope了，controller更加的POJO，就是一个很普通的JavaScript对象。</li>
<li>也因为没有了$scope，而controller实例将会成为scope上的一个属性，所以在controller中我们再也不能使用$watch,$emit,$on之类的特殊方法，因为这些东西往往不该出现在controller中的，给大家一个警告，更好的控制。但是一旦如果没办法必须用的话，可以在征得项目组一致同意，将此controller退回$scope.</li>
<li>因为controller实例将会只是$scope的一个属性，所以view模板上的所有字段都会在一个引用的属性上，这可以避开JavaScript原型链继承对于值类型的坑。参加<a href="https://github.com/angular/angular.js/wiki/Understanding-Scopes">https://github.com/angular/angular.js/wiki/Understanding-Scopes</a>.</li>
<li>controller as 对于 coffescript,liveScript更友好。
7.模板上定义的每个字段方法都会在scope寄存在controller as别名上的引用上，所以在controller继承中，不会在出现命名冲突的问题。</li>
</ol>


<p>注释:对于route，也有个controllerAs的属性可以设置，下面代码来之angular doc文档：</p>

<pre class='green'><code>    angular.module('ngViewExample', ['ngRoute', 'ngAnimate'],
     function($routeProvider, $locationProvider) {
    $routeProvider.when('/Book/:bookId', {
      templateUrl: 'book.html',
      controller: BookCntl,
      controllerAs: 'book'
    });
    $routeProvider.when('/Book/:bookId/ch/:chapterId', {
      templateUrl: 'chapter.html',
      controller: ChapterCntl,
      controllerAs: 'chapter'
    });

    // configure html5 to get links working on jsfiddle
         $locationProvider.html5Mode(true);
     });
</code></pre>

<p>今天就到这里，谢谢。</p>
=======
  <div class="entry-content"><p>Excel转化货币数字为中文大写：例如：</p>

<p>效果图：</p>

<p><img src="http://images.cnblogs.com/cnblogs_com/whitewolf/ExcelP.jpg" alt="" /></p>

<p>代码：</p>

<pre><code> =IF(D8&lt;1,IF(D8&lt;0.1,TEXT(INT(D8*100),"[DBNum2]G/通用格式")&amp;"分",IF((INT(D8*100)-INT(D8*10)*10=0),TEXT(INT(D8*10),"[DBNum2]G/通用格式")&amp;"角整",TEXT(INT(D8*10),"[DBNum2]G/通用格式")&amp;"角"&amp;TEXT(INT(D8*100)-INT(D8*10)*10,"[DBNum2]G/通用格式")&amp;"分")),TEXT(INT(D8),"[DBNum2]G/通用格式"&amp;"元")&amp;IF((INT(D8*10)-INT(D8)*10)=0,IF((INT(D8*100)-INT(D8*10)*10)=0,"","零"),IF((INT(D8*0.1)-INT(D8)*0.1)=0,"零","")&amp;TEXT(INT(D8*10)-INT(D8)*10,"[DBNum2]G/通用格式")&amp;"角")&amp;IF((INT(D8*100)-INT(D8*10)*10)=0,"整",TEXT(INT(D8*100)-INT(D8*10)*10,"[DBNum2]G/通用格式")&amp;"分"))
</code></pre>

<p>&nbsp;这个奖可以结合ASPOSE.Cells处理我的报表导出Excel的汇总，计算问题：<a href="http://www.cnblogs.com/whitewolf/archive/2011/03/21/Aspose_Cells_Template1.html"><font color="#6699cc">报表中的Excel操作之Aspose.Cells（Excel模板）</font></a> 唯一需要改变的就是D8这个单元汇总格是需要动态变更的，可以利用{r}。{-n}，{c}等来处理。</p>

<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;本文通过程序<a href="https://github.com/greengerong/cnblogs-blogs2markdown" title="cnblogs-blogs2markdown">cnblogs-blogs2markdown</a>转换的,如质量有问题<a href="http://www.cnblogs.com/whitewolf/archive/2011/03/26/1996192.html" title="原文首发">原文首发请看这里</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/03/12/Python-Tools-for-Visual-Studio/">Python Tools for Visual Studio</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-03-12T00:00:00+08:00" pubdate data-updated="true"></time>
        
           | <a href="/blog/2011/03/12/Python-Tools-for-Visual-Studio/#disqus_thread"
             data-disqus-identifier="http://greengerong.github.io/blog/2011/03/12/Python-Tools-for-Visual-Studio/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>&#160;&#160;&#160; 今天在CodeProject订阅中看这个开源项目，简单的看了看项目介绍，和测试。这对于喜欢CPython、IronPython的朋友们来说，该是一个喜悦，现在在ms的开源项目支持下，我们可以就在我们的vs2010IDE下编写程序了。</p>

<p>下面是CodePlex上的一个效果展示：Python Tools for Visual Studio主页：<a href="http://pytools.codeplex.com/" title="http://pytools.codeplex.com/">http://pytools.codeplex.com/</a></p>

<p> CPython and IronPython</p>

<p><a href="http://images.cnblogs.com/cnblogs_com/whitewolf/201103/201103121111565782.png"><img src="http://images.cnblogs.com/cnblogs_com/whitewolf/201103/201103121111575060.png" title="p_intro_pic_med2" alt="p_intro_pic_med2" /></a></p>

<p> 现在还是Beta版：支持智能感知、CPython 和 IronPython，NumPy &amp; SciPy for .Net、本地和远程调试、支持并行计算，很快聚会支持以当下流行的云计算、大规模，数据密集型并行编程（Dryad）。</p>

<p>其他资料：
  <li>CPython <a href="http://www.python.org">http://www.python.org</a>;</li>  <li>IronPython <a href="http://ironpython.codeplex.com">http://ironpython.codeplex.com</a>;</li>  <li>IPython <a href="http://ipython.scipy.org">http://ipython.scipy.org</a> ;</li>  <li>NumPy/SciPy&#160; <a href="http://scipy.org">http://scipy.org</a>;</li>  <li>NumPy/SciPy for .Net 将会在: <a href="http://scipy.org">http://scipy.org</a> ；</li></p>

<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;本文通过程序<a href="https://github.com/greengerong/cnblogs-blogs2markdown" title="cnblogs-blogs2markdown">cnblogs-blogs2markdown</a>转换的,如质量有问题<a href="http://www.cnblogs.com/whitewolf/archive/2011/03/12/1982093.html" title="原文首发">原文首发请看这里</a></p>
>>>>>>> 0bab7647fe4f4f5795aed418af9d97aabf2983a0
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
<<<<<<< HEAD
      <h1 class="entry-title"><a href="/blog/2013/12/15/jqueryinputmarsk4angular/">Angularjs组件之input Mask</a></h1>
=======
      <h1 class="entry-title"><a href="/blog/2011/03/05/duan-dian/">断电</a></h1>
>>>>>>> 0bab7647fe4f4f5795aed418af9d97aabf2983a0
    
    
      <p class="meta">
        








  


<<<<<<< HEAD
<time datetime="2013-12-15T00:00:00+08:00" pubdate data-updated="true"></time>
=======
<time datetime="2011-03-05T00:00:00+08:00" pubdate data-updated="true"></time>
        
           | <a href="/blog/2011/03/05/duan-dian/#disqus_thread"
             data-disqus-identifier="http://greengerong.github.io/blog/2011/03/05/duan-dian/">Comments</a>
>>>>>>> 0bab7647fe4f4f5795aed418af9d97aabf2983a0
        
      </p>
    
  </header>


<<<<<<< HEAD
  <div class="entry-content"><p>今天将奉献一个在在几个angularjs项目中抽离的angular组件 input mask。在我们开发中经常会对用户的输入进行控制，比如日期，货币格式，或者纯数字格式之类的限制，这就是input mask的使用场景，在项目中也是会经常被提及需的需求之一。</p>

<p>当然在官方的angular-ui ui-utils中有一个相应的组件叫做ui-mask，但是其mask功能是很初级脆弱的。所以我希望能得到一个更强大的mask组件。我所知的<a href="https://github.com/RobinHerbots/jquery.inputmask">jquery.inputmask</a>就是这样一个我所期望的强大的mask组件，所以我不必再去重造轮子，好的软件就是为了不停被重复利用。所以写了一个adapter，<a href="https://github.com/greengerong/green.inputmask4angular">https://github.com/greengerong/green.inputmask4angular</a>.</p>

<p>其使用如下，可以去下载项目查看其中的demo page。</p>

<pre class='green'><code>&lt;div class="hero-unit"&gt;
                &lt;h1&gt;'Allo, 'Allo!&lt;/h1&gt;

                &lt;div&gt;
                    &lt;h3&gt;mask&lt;/h3&gt;
                    &lt;p&gt;Mask: 99-9999999&lt;/p&gt;
                    &lt;input type="text" ng-model="test" input-mask="'mask'" mask-option="testoption"/&gt;
                    &lt;pre&gt;{{ test | json }}&lt;/pre&gt;
                &lt;/div&gt;

                &lt;div&gt;
                    &lt;h3&gt;y-m-d&lt;/h3&gt;
                    &lt;p&gt;Date: yyyy-MM-dd&lt;/p&gt;
                    &lt;input type="text" ng-model="test1" input-mask="'y-m-d'" format-option="dateFormatOption"/&gt;
                    &lt;pre&gt;{{ test1 | json }}&lt;/pre&gt;
                &lt;/div&gt;


                &lt;div&gt;
                    &lt;h3&gt;Regex&lt;/h3&gt;
                    &lt;p&gt;Email: "[a-zA-Z0-9._%-]+@[a-zA-Z0-9-]+\\.[a-zA-Z]{2,4}"&lt;/p&gt;
                    &lt;input type="text" ng-model="test3" input-mask="'Regex'"
                     mask-option="regexOption"/&gt;
                    &lt;pre&gt;{{ test3 | json }}&lt;/pre&gt;
                &lt;/div&gt;

                &lt;div&gt;
                    &lt;h3&gt;Function&lt;/h3&gt;
                    &lt;p&gt;"[1-]AAA-999" or  "[1-]999-AAA"&lt;/p&gt;
                    &lt;input type="text" ng-model="test4" input-mask="functionOption"/&gt;
                    &lt;pre&gt;{{ test4 | json }}&lt;/pre&gt;
                &lt;/div&gt;

            &lt;/div&gt;
</code></pre>

<p> controller code:</p>

<pre class='green'><code>'use strict';

    angular.module('green.inputmaskApp')
        .controller('MainCtrl', ["$scope", function ($scope) {

            $scope.testoption = {
                "mask": "99-9999999",
                "oncomplete": function () {
                    console.log();
                    console.log(arguments,"oncomplete!this log form controler");
                },
                "onKeyValidation": function () {
                    console.log("onKeyValidation event happend! this log form controler");
                }
            }

            //default value
            $scope.test1 = new Date();

            $scope.dateFormatOption = {
                parser: function (viewValue) {
                    return viewValue ? new Date(viewValue) : undefined;
                },
                formatter: function (modelValue) {
                    if (!modelValue) {
                        return "";
                    }
                    var date = new Date(modelValue);
                    return (date.getFullYear() + "-" + date.getMonth() + "-" + date.getDate()).replace(/\b(\d)\b/g, "0$1");
                },
                isEmpty: function (modelValue) {
                    return !modelValue;
                }
            };


            $scope.mask = { regex: ["999.999", "aa-aa-aa"]};


            $scope.regexOption = {
                regex: "[a-zA-Z0-9._%-]+@[a-zA-Z0-9-]+\\.[a-zA-Z]{2,4}"
            };

            $scope.functionOption = {
             mask: function () { 
                return ["[1-]AAA-999", "[1-]999-AAA"]; 
            }};


        }]);
</code></pre>

<p>这里值列列举了jquery.inputmask的简单实用方式，更复杂的方式请移步到jquery.inputmask查看。</p>
=======
  <div class="entry-content"><p>&shy;</p>

<p>与屋外的夜融合&shy;</p>

<p>没了相伴的影&shy;</p>

<p>去了柳绿花红,还有&shy;</p>

<p>面部的表情,&shy;</p>

<p>正如落魄的&shy;茫然</p>

<p>死亡的静谧 &shy;</p>

<p>&shy;</p>

<p>我在内心默祷&shy;</p>

<p>任书桌的狼籍 &shy;</p>

<p>墨汁的飘洒 &shy;</p>

<p>黑的延续&shy;</p>

<p>尽情低落的幸福</p>

<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &mdash;破狼</p>

<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;本文通过程序<a href="https://github.com/greengerong/cnblogs-blogs2markdown" title="cnblogs-blogs2markdown">cnblogs-blogs2markdown</a>转换的,如质量有问题<a href="http://www.cnblogs.com/whitewolf/archive/2011/03/05/1971372.html" title="原文首发">原文首发请看这里</a></p>
>>>>>>> 0bab7647fe4f4f5795aed418af9d97aabf2983a0
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
<<<<<<< HEAD
      <h1 class="entry-title"><a href="/blog/2013/12/15/angular-model--format/">Angular Ng-model类型格式转化</a></h1>
=======
      <h1 class="entry-title"><a href="/blog/2011/03/04/html5-web-ben-di-cun-chu/">Html5-web本地存储</a></h1>
>>>>>>> 0bab7647fe4f4f5795aed418af9d97aabf2983a0
    
    
      <p class="meta">
        








  


<<<<<<< HEAD
<time datetime="2013-12-15T00:00:00+08:00" pubdate data-updated="true"></time>
=======
<time datetime="2011-03-04T00:00:00+08:00" pubdate data-updated="true"></time>
        
           | <a href="/blog/2011/03/04/html5-web-ben-di-cun-chu/#disqus_thread"
             data-disqus-identifier="http://greengerong.github.io/blog/2011/03/04/html5-web-ben-di-cun-chu/">Comments</a>
>>>>>>> 0bab7647fe4f4f5795aed418af9d97aabf2983a0
        
      </p>
    
  </header>


<<<<<<< HEAD
  <div class="entry-content"><p>在angular开发中我们经常会遇见输入框中的string的值，却想在scope上的model表现为整型、浮点、货币，或者在radio的value是一个true,false的Boolean类型，一组check box的vlue组成一个Array的数组类型，因为我们的后台程序的model设计接口如此。你是否还在后台应用程序或者ajax提交前做mapper，还在重复着着伪angular的做法？</p>

<p>在本人github创建了一个开源项目<a href="https://github.com/greengerong/ngmodel-format">https://github.com/greengerong/ngmodel-format</a>,为了让我们能够轻易的对付这些琐事，你可以在demo下得html或者middle way的测试中看见其使用方法，同时如果不满足你的需求，你仍然可以很简单的扩展你需要的功能：你需要的只是在你的module的run阶段注入modelFormatConfig的constant service 加入所需的key值，加上自己的formatter，parser，isEmpty方法，如果你仍然想继续深入的对用户的输入进行一些控制的话，也可以加入keyDown时间去stopPropagation，preventDefault一些key值。</p>

<p>下面我们看看其相应的使用方式：</p>

<p>请移步到<a href="http://jsbin.com/uJUrANa/1/watch?html,js,output">http://jsbin.com/uJUrANa/1/watch?html,js,output</a>，由于嵌入iframe对样式存在影响，所以暂不嵌入</p>

<p>注意由于在jsbin拒绝引入github text/plain的文件 所以这里是直接把源码贴进去了的，如果使用的话最好是使用github上的，这里的代码是不会更新的。</p>

<p>在jsbin demo上你能够很清楚的看见使用方式。那么我就不用在废话多说了，哈哈。有问题可以提交github issue。</p>
=======
  <div class="entry-content"><blockquote><p>&nbsp;&nbsp; 在html5中为我们提供了一种本地缓存机制，它将取代我们的cookie，并且它是不会随浏览器发会我们的服务器端的。我们可以采用js在客户端自由的操作本地缓存。html5中缓存主要有localStorage，和sessionStorage。他们的用法一致。区别在于他们的时间限制不同。localStorage是不存在时间限制的。而sessionStorage这时基于session的数据存储，在关闭或者离开网站后，数据将会被删除。</p>

<p>&nbsp; 下面我们来简单看看官方的示例操作：</p>

<p><strong>javascript</strong></p>

<p>localStorage.fresh = &#8220;vfresh.org&#8221;;&nbsp;&nbsp; //设置一个键值
var a = localStorage.fresh;&nbsp;&nbsp; //获取键值</p>

<p>或者使用它的API：
<strong>javascript</strong></p>

<p>//清空storage
localStorage.clear();</p>

<p>//设置一个键值
localStorage.setItem(&#8220;fresh&#8221;,&#8220;vfresh.org&#8221;);</p>

<p>//获取一个键值
localStorage.getItem(&#8220;fresh&#8221;);&nbsp;</p>

<p>//return &#8220;vfresh.org&#8221; //获取指定下标的键的名称（如同Array）
localStorage.key(0);&nbsp;</p>

<p>//return &#8220;fresh&#8221; //删除一个键值
localStorage.removeItem(&#8220;fresh&#8221;);</p>

<p>&nbsp;</p></blockquote>

<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sessionStorage相同就不用在废话了，他相当于我们的过期时间Expire=0的cookie；</p>

<p>&nbsp;</p>

<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;本文通过程序<a href="https://github.com/greengerong/cnblogs-blogs2markdown" title="cnblogs-blogs2markdown">cnblogs-blogs2markdown</a>转换的,如质量有问题<a href="http://www.cnblogs.com/whitewolf/archive/2011/03/04/1970457.html" title="原文首发">原文首发请看这里</a></p>
>>>>>>> 0bab7647fe4f4f5795aed418af9d97aabf2983a0
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
<<<<<<< HEAD
      <h1 class="entry-title"><a href="/blog/2013/12/11/angularjs-web-component/">Web组件化-angularjs实践</a></h1>
=======
      <h1 class="entry-title"><a href="/blog/2011/03/04/Wpf-xiao-xi-xun-huan-zhi-xiao-xi-chuan-di/">Wpf消息循环之消息传递</a></h1>
>>>>>>> 0bab7647fe4f4f5795aed418af9d97aabf2983a0
    
    
      <p class="meta">
        








  


<<<<<<< HEAD
<time datetime="2013-12-11T00:00:00+08:00" pubdate data-updated="true"></time>
=======
<time datetime="2011-03-04T00:00:00+08:00" pubdate data-updated="true"></time>
        
           | <a href="/blog/2011/03/04/Wpf-xiao-xi-xun-huan-zhi-xiao-xi-chuan-di/#disqus_thread"
             data-disqus-identifier="http://greengerong.github.io/blog/2011/03/04/Wpf-xiao-xi-xun-huan-zhi-xiao-xi-chuan-di/">Comments</a>
>>>>>>> 0bab7647fe4f4f5795aed418af9d97aabf2983a0
        
      </p>
    
  </header>


<<<<<<< HEAD
  <div class="entry-content"><p>在过去的web标准经历了一个飞速的发展，随着时间的推移，用户对web的体验也越来越重视，从最初的简单静态页面到以ajax标志的web2.0，在这个时代我们所面临的问题是用户的体验和可恶的浏览器的兼容(IE成为了我们所唾弃的产物，IE6的葬礼之类的形式足以表明这点)，所以有了Prototype，Mootools，jQuery这类浏览器兼容和util的库，特别jQuery的出现以其独特的兼容性，一致性和优雅的选择器和链式风格影响了整个业界的发展,作为这个时代的产物jQuery是个很出色的库，正的如它所说，做到了&#8221;write less，do more&#8221;,成为这个时代的标志。然而随着互联网的突增，我们的JavaScript代码量也暴增，是的我们再度陷入到JavaScript的维护管理的困境。JavaScript本来是一门作为浏览器上的脚本语言出身，并不适合于大规模开发。所以在我们所能看见的MDV框架的出现，这个时候前段的JavaScript代码已得到我们越来越注重，MDV框架提出了我们也需要向对待后端系统(spring,web api)一样对前段逻辑进行统一管理，分层(表现逻辑，viewmodel，视图)。所以Backbone，AngularJS，Ember，Spine之类的数据绑定框架横空出世，力求给我们带来代码的模块管理，数据、视图的分离，他们以他们不同的方式解决共同的问题：</p>

<p>1.如何更好地模块化开发</p>

<p>2.业务数据如何组织</p>

<p>3.界面和业务数据，业务逻辑的分离</p>

<p>与此同时其实用户体验的要求html5，ECMAScript也在快速的推进。在这里我想说的是 Web组件化的也在蓬勃的发展起来，以Google额polymer为代表的框架，库也在悄无声息的到来，虽然这需要等到浏览器的大统一，但是我们相信在不久的将来将会到来。在这里我所激动和希望是组件的共享，假设我们能够一个想java maven repo，cdn之类的共有或者私有repo，在你需要的地方只需要import那将是多么美好的事情，这也许是意淫，但也未必不可。</p>

<p>有希望总是好的，在过去一年我所尝试的就是基于angular这优秀的框架directive dsl和maven build去实现我所期望的组件化共享愿景。在基于node的<a href="http://component.io/">component</a>前端管理框架稍有相似之处。</p>

<p>回到正题，在angularjs中如何去做到组件化：</p>

<p><img src="/images/blog_img/web-angular.jpg" alt="/images/blog_img/web-angular.jpg" /></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/12/10/use-phantomjs-to-get-pdf/">生成PDF的新选择-Phantomjs</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-12-10T00:00:00+08:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>最近在node.js项目开发中，遇见生成PDF的需求，当然生成PDF不是一个新意的需求；我可以选择利用开源的pdfkit或者其他node pdf模块，或者通过edge.js调用.net/python下的pdf库去做生成pdf。但是在我看来对于这些东西不管如何也需要花费我们太多的时间(pdf报表的内容报表很复杂)，不如把所有的画图实现逻辑推向大家所熟悉的html+css来的简洁，快速，这样对于pdf格式变化和图形计算逻辑的变化推到ejs、jade之类的模板引擎，对于以后的修改维护扩展是个很不错的选择。所以选择phantomjs加载页面生成PDF对于我来说不是个不错的选择，同时对于html+css我所需要兼容的仅有webkit一种浏览器，没有厌恶的浏览器兼容性顾虑。所以说做就做，我在项目上花了半个小时配置phantomjs的自动化脚本（在各环境能够自动勾践），以及实现了一个简单页面的PDF转化。</p>

<p>rasterize.js（来自官方pdf demo）：</p>

<pre class='green'><code>var page = require('webpage').create(),
        system = require('system'),
        address, output, size;

    if (system.args.length &lt; 3 || system.args.length &gt; 5) {
        console.log('Usage: rasterize.js URL filename [paperwidth*paperheight|paperformat] [zoom]');
        console.log('  paper (pdf output) examples: "5in*7.5in", "10cm*20cm", "A4", "Letter"');
        phantom.exit(1);
    } else {
        address = system.args[1];
        output = system.args[2];
        page.viewportSize = { width: 600, height: 600 };
        if (system.args.length &gt; 3 &amp;&amp; system.args[2].substr(-4) === ".pdf") {
            size = system.args[3].split('*');
            page.paperSize = size.length === 2 ? { width: size[0], height: size[1], margin: '0px' }
                : { format: system.args[3], orientation: 'portrait', margin: '1cm' };
        }
        if (system.args.length &gt; 4) {
            page.zoomFactor = system.args[4];
        }
        page.open(address, function (status) {
            if (status !== 'success') {
                console.log('Unable to load the address!');
                phantom.exit();
            } else {
                window.setTimeout(function () {
                    page.render(output);
                    phantom.exit();
                });
            }
        });
    }
</code></pre>

<p>在node调用端，使用exec调用命令行输入得到文件并返回到node response流：</p>

<p>guid utils:</p>

<pre class='green'><code>    'use strict';

    var guid = function () {
        var uid = 0;
        this.newId = function () {
            uid = uid % 1000;
            var now = new Date();
            var utc = new Date(now.getTime() + now.getTimezoneOffset() * 60000);
            return utc.getTime() + uid++;
        }
    }

    exports.utils = {
        guid: new guid()
    };
</code></pre>

<p>pdfutil:</p>

<pre class='green'><code>    'use strict';

    var exec = require('child_process').exec;
    var utils = require('./utils').utils;
    var nodeUtil = require('util');

    var outPut = function (id, req, res) {
        var path = nodeUtil.format("tmp/%s.pdf", utils.guid.newId());
        var port = req.app.settings.port;
        var pdfUrl = nodeUtil.format("%s://%s%s/pdf/%s", req.protocol, req.host, ( port == 80 || port == 443 ? '' : ':' + port ), id);

        exec(nodeUtil.format("phantomjs tool/rasterize.js %s %s A4", pdfUrl, path), function (error, stdout, stderr) {
            if (error || stderr) {
                res.send(500, error || stderr);
                return;
            }
            res.set('Content-Type', 'application/pdf');
            res.download(path);
        });

    };

    exports.pdfUtils = {
        outPut: outPut
    };
</code></pre>

<p>响应的代码也可以很好的转换为java/c#&hellip;的命令行调用来得到pdf并推送到response流中。一切都这么简单搞定。</p>

<p>node也有node-phantom模块，但是用它生成的pdf样式有点怪，所以最后还是坚持采用了exec方式去做。</p>

<p>还有就是phantomjs生成PDF不会把css的背景色和北京图片带进去，所以对于这块专门利用了纯色图片img标签，并position:relative或者absolute去定位文字.这点还好因为这个页面上用户不会看的，</p>

<p>文章也到此结尾，希望多多交流，继续关注，谢谢大家。</p>
=======
  <div class="entry-content"><p>&nbsp;&nbsp;&nbsp;&nbsp; 几天遇见一个问题需要检查某个wpf程序是否已经运行，如果没有运行则启动传递参数，如果已运行则需要直接传递消息。在没有运行 情况下传递参数很简单，我们只需要Process cmd窗口启动并传递参数，在程序中处理。但是如果程序已经启动有点麻烦，凭着我曾winform的经验第一时间想到的是win32 api&nbsp; SendMessage,我们的C#程序只需要DllImport就可以调用了。经过一番查找和对wpf window和DispatcherObject的Reflector，花了我大半天终于找到了System.Windows.Interop.HwndSource中有AddHock方法可以添加对win32消息机制的监听。这下就很好办了我们只需要注册MainWindow的这个时间，来监听win32消息处理我们的0x004A消息。</p>

<p>&nbsp;&nbsp;&nbsp; 控制台代码，主要应用的FindWindow 这个win32方法查找我们的窗体，SendMessage发送我们的消息，和winform没有什么差别，对于win32的使用你可以参考<a href="http://www.cnblogs.com/speeding/">毒龙的程序人生</a> 的<a href="http://www.cnblogs.com/speeding/archive/2004/10/24/56033.html">关于C#中实现两个应用程序消息通讯的问题</a>。难得查win32 Api直接copy，借来用用。</p>

<p>程序：</p>

<pre><code>using System; 
using System.Collections.Generic; 
using System.Linq; 
using System.Text; 
using System.Runtime.InteropServices; 

namespace ConsoleApplication1 
{ 
    class Program 
    { 
        static void Main(string[] args) 
        { 
            string ch = ""; 
            while (ch.ToLower() != "q") 
            { 

                if (!SendMessage("Window1", @"Hello,I am from Console Program:" + ch)) 
                { 
                   Console.WriteLine("no window");

                }; 
                ch = Console.ReadLine(); 
            } 
        } 

        public static bool SendMessage(string windowName, string strMsg) 
        { 
            if (strMsg == null) return true; 
            IntPtr hwnd = (IntPtr)FindWindow(null, windowName   ); 
            if (hwnd != IntPtr.Zero) 
            { 
                CopyDataStruct cds; 
                cds.dwData = IntPtr.Zero; 
                cds.lpData = strMsg; 
                cds.cbData = System.Text.Encoding.Default.GetBytes(strMsg).Length + 1; 
                int fromWindowHandler = 0; 
                SendMessage(hwnd, 0x004A, fromWindowHandler, ref  cds); 
                return true; 
            } 
            return false; 
        } 

        [DllImport("User32.dll", EntryPoint = "FindWindow")] 
        private static extern int FindWindow(string lpClassName, string lpWindowName); 

        [DllImport("User32.dll", EntryPoint = "SendMessage")] 

        private static extern int SendMessage 

        ( 

        IntPtr hWnd, 

        int Msg, 

        int wParam, 

        ref  CopyDataStruct lParam 

        ); 

    } 

    [StructLayout(LayoutKind.Sequential)] 

    public struct CopyDataStruct 
    { 

        public IntPtr dwData; 

        public int cbData; 

        [MarshalAs(UnmanagedType.LPStr)] 

        public string lpData; 

    } 

}
</code></pre>

<p>&nbsp;wpf端程序：主要需要在MainWindow中loaded事件订阅消息监听：这里需要System.Windows.Interop.HwndSource的AddHock方法注册
程序：</p>

<pre><code>  IntPtr WndProc(IntPtr hwnd, int msg, IntPtr wParam, IntPtr lParam, ref bool handled) 
         { 

             if (msg == 0x004A) 
             { 

                 CopyDataStruct cds = (CopyDataStruct)System.Runtime.InteropServices.Marshal.PtrToStructure(lParam, typeof(CopyDataStruct)); 

                 MessageBox.Show(cds.lpData); 
                 this.Visibility = Visibility.Visible; 
             } 

             return hwnd; 

         } 

         private void Window_Loaded(object sender, RoutedEventArgs e) 
         {           

             (PresentationSource.FromVisual(this) as System.Windows.Interop.HwndSource).AddHook(new System.Windows.Interop.HwndSourceHook(WndProc)); 
         }
</code></pre>

<p>截个图：</p>

<p><a href="http://images.cnblogs.com/cnblogs_com/whitewolf/201103/201103042248312846.jpg"><img src="http://images.cnblogs.com/cnblogs_com/whitewolf/201103/201103042248334156.jpg" title="GDVCJ_1PZO7SU((~1}41XSG" alt="GDVCJ_1PZO7SU((~1}41XSG" /></a></p>

<p>很简单的东西结果被MS封装的不知哪里去，让我查了半天（其实应该是我的无知吧，不管怎么解决了就是心情舒畅了）；</p>

<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;本文通过程序<a href="https://github.com/greengerong/cnblogs-blogs2markdown" title="cnblogs-blogs2markdown">cnblogs-blogs2markdown</a>转换的,如质量有问题<a href="http://www.cnblogs.com/whitewolf/archive/2011/03/04/1971300.html" title="原文首发">原文首发请看这里</a></p>
>>>>>>> 0bab7647fe4f4f5795aed418af9d97aabf2983a0
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
<<<<<<< HEAD
      <h1 class="entry-title"><a href="/blog/2013/12/08/prerender-seo-for-single-page-application/">prerender-SPA程序的SEO优化策略</a></h1>
=======
      <h1 class="entry-title"><a href="/blog/2011/03/02/html5-Canvas-hui-tu/">html5-Canvas绘图</a></h1>
>>>>>>> 0bab7647fe4f4f5795aed418af9d97aabf2983a0
    
    
      <p class="meta">
        








  


<<<<<<< HEAD
<time datetime="2013-12-08T00:00:00+08:00" pubdate data-updated="true"></time>
=======
<time datetime="2011-03-02T00:00:00+08:00" pubdate data-updated="true"></time>
        
           | <a href="/blog/2011/03/02/html5-Canvas-hui-tu/#disqus_thread"
             data-disqus-identifier="http://greengerong.github.io/blog/2011/03/02/html5-Canvas-hui-tu/">Comments</a>
>>>>>>> 0bab7647fe4f4f5795aed418af9d97aabf2983a0
        
      </p>
    
  </header>


<<<<<<< HEAD
  <div class="entry-content"><p>随着web2.0的兴起，ajax的时代已经成为了事实，更如今Knockout,backbone, angular,ember前端MDV(model driver view)框架强势而来，Single Page Application已经为大家所熟悉了。如今常见的SPA程序，restfull和前端MDV之类的框架能够实实在在的减少我们的代码开发量，让我更多的注意力关注在真正的业务逻辑上。在众多前端MDV框架从博客中可以看出来笔者还是钟爱于angular，然而服务端平台的选择的话：在.net平台笔者会首选webapi+oData,jvm平台spring restfull。</p>

<p>但是相应带来的是搜索引擎优化(SEO)是个难题，因为爬虫不会去执行JavaScript。现在很幸运的是在Google推出angular之后，也给出了一些解决方案：<a href="https://developers.google.com/webmasters/ajax-crawling/docs/getting-started">Google&rsquo;s ajax crawling protocol</a>.此协议现在已被Google和bing所实现。</p>

<p>在协议中规定，搜索引擎会把带有#!someurl的链接转换为<em>escaped_fragment</em>=someurl访问解析，例如：</p>

<pre class='green'><code>www.example.com/ajax.html#!key=value
</code></pre>

<p>将会变为</p>

<pre class='green'><code>www.example.com/ajax.html?_escaped_fragment_=key=value
</code></pre>

<p>所以如果我们需要更好的SEO的支持的话，我们可以从现在开始把我们程序中的#变为#！,特别angular程序，因为框架原生支持对#！的解析。</p>

<p>基于这个协议和phantomjs(headless的浏览器内核)我们的SPA SEO工具 <a href="http://prerender.io/">prerender(http://prerender.io/)</a>应运而生，在官方和社区的支持下，现在已经有node.js express,ruby on rails,java,asp.net,php,python主流框架和nginx之类的支持。</p>

<p>prerender架构流程图如下：</p>

<p><img src="/images/blog_img/prerender.jpg" alt="/images/blog_img/prerender.jpg" /></p>

<p>prerender分为两个部分一部分为后端云服务和应用程序客户端，客户端主要拦截来自爬虫的请求在转发到后端云服务处理返回处理后并且去掉多余script/css的html在返回给爬虫。</p>

<p>后端云服务（nodejs项目），利用phantomjs这个无ui headless的浏览器内核加载页面地址，并等到页面解析后获取document html，并处理去掉无用的部分返回到前段客户端程序。</p>

<p>而前段程序则为不同语言框架而实现的不同拦截器，如java的filter，asp.net mvc的HttpModule，主要任务为拦截请求并转发给后端云服务处理。其拦截规则为：</p>

<ol>
<li>检查url中是否带有<em>escaped_fragment</em>或者请求user-agent是已知或者配置的爬虫user-agent</li>
<li>确认拦截的不是js,css之类的资源文件</li>
<li>在确认url是在白名单中（可选如果配置的白名单的话）</li>
<li>确认不应该在黑名单中(可选如果配置了黑名单的话)</li>
</ol>


<p>注：最好值配置黑名单或者白名单中的一种方式。</p>

<p>有了prerender，因为SEO而放弃SPA不再是理由了，关于prerender的任何issue大家可以及时提出，让它更加完善。具体关于如何使用和测试请转向主页和各个client程序页面，<a href="http://prerender.io/">http://prerender.io/</a></p>
=======
  <div class="entry-content"><p>&nbsp;&nbsp;&nbsp; 在html5中我觉得最重要的就是引入了Canvas，使得我们可以在web中绘制各种图形。给人感觉单在这点上有点模糊我们web和桌面程序的感觉。在html5外web中也有基于xml的绘图如：VML、SVG。而Canvas为基于像素的绘图。Canvas是一个相当于画板的html节点，我们必须以js操作绘图。</p>

<p>如下：</p>

<p>&lt;canvas id=&ldquo;myCanvas&rdquo; width=&ldquo;600&rdquo; height=&ldquo;300&rdquo;&gt;你的浏览器还不支持哦&lt;/canvas&gt;定义。</p>

<p>我们可以获取canvas对象为var c=document.getElementById(&ldquo;myCanvas&rdquo;);其应有js属性方法如下列举：</p>

<p>1：绘制渲染对象，c.getContext(&ldquo;2d&rdquo;),获取2d绘图对象，无论我们调用多少次获取的对象都将是相同的对象。</p>

<p>2：绘制方法：</p>

<p>clecrRect(left,top,width,height)清除制定矩形区域，</p>

<p>fillRect(left,top,width,height)绘制矩形，并以fillStyle填充。</p>

<p>fillText（text,x,y）绘制文字；</p>

<p>strokeRect(left,top,width,height)绘制矩形，以strokeStyle绘制边界。</p>

<p>beginPath():开启路径的绘制,重置path为初始状态；</p>

<p>closePath():绘制路径path结束，它会绘制一个闭合的区间，添加一条起始位置到当前坐标的闭合曲线；</p>

<p>moveTo（x，y）：设置绘图其实坐标。</p>

<p>lineTo(x，y);绘制从当前其实位置到x，y直线。</p>

<p>fill（），stroke（），clip（）：在完成绘制的最后的填充和边界轮廓，剪辑区域。</p>

<p>arc（）：绘制弧,圆心位置、起始弧度、终止弧度来指定圆弧的位置和大小；</p>

<p>rect():矩形路径;</p>

<p>drawImage（Imag img）：绘制图片；</p>

<p>quadraticCurveTo():二次样条曲线路径,参数两个控制点；</p>

<p>bezierCurveTo（）：贝塞尔曲线，参数三个控制点；</p>

<p>createImageData,getImageData，putImageData:为Canvas中像素数据。ImageData为记录width、height、和数据 data，其中data为我们色素的记录为</p>

<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; argb，所以数组大小长度为width<em>height</em>4，顺序分别为rgba。getImageData为获取矩形区域像素，而putImageData则为设置矩形区域像素；</p>

<p>&#8230; and so on！</p>

<p>3：坐标变换：</p>

<p>translate（x,y）：平移变换，原点移动到坐标（x，y）；</p>

<p>rotate（a）：旋转变换，旋转a度角；</p>

<p>scale（x，y）：伸缩变换；</p>

<p>save（），restore（）：提供和一个堆栈，保存和恢复绘图状态，save将当前绘图状态压入堆栈，restore出栈，恢复绘图状态；</p>

<p>&#8230; and so on！</p>

<p>好了，也晚了。附我的测试代码，：</p>

<pre><code>&lt;html&gt; 
  &lt;head&gt; 
  &lt;/head&gt; 
  &lt;body&gt; 
  &lt;canvas id="myCanvas" width="600" height="300"&gt;你的浏览器还不支持哦&lt;/canvas&gt; 
  &lt;script type="text/javascript"&gt; 

  var width,height,top,left; 
  width=height=100; 
  top=left=5; 
  var x=10; 
  var y=10; 

  var c=document.getElementById("myCanvas"); 

  var maxwidth=c.width-5; 
  var maxheight=c.height-5; 
  var cxt=c.getContext("2d"); 
  cxt.strokeStyle="#00f"; 
  cxt.strokeRect(0,0,c.width,c.height); 

  var img=new Image(); 
  img.src="1.gif"; 
  var MyInterval=null; 
  start(); 
  function Refresh(){ 
  cxt.clearRect(left,top,width,height); 
  if((left+x)&gt;(maxwidth-width)||left+x&lt;0){ 
  x=-x; 
  } 

  if((top+y)&gt;(maxheight-height)||top+y&lt;0){ 
  y=-y; 
  } 

  left=left+x;    
  top=top+y; 
  cxt.drawImage(img,left,top,width,height); 
  cxt.font="20pt 宋体"; 
  cxt.fillText("破狼",left,top+25); 

  } 

  function start(){ 
  if(MyInterval==null){ 
  MyInterval=setInterval("Refresh()",100); 
  } 
  } 

  function stop(){ 
  if(MyInterval!=null){ 
  clearInterval(MyInterval); 
  MyInterval=null; 
  } 
  } 
  function InRectangle(x,y,rectx,recty,rwidth,rheight){ 
  return (x&gt;=rectx&amp;&amp;x&lt;=rectx+rwidth)&amp;&amp;(y&gt;=recty&amp;&amp;y&lt;=recty+rheight) 
  } 
  c.onmouseover=function(e){ 
  if(InRectangle(e.clientX,e.clientY,left,top,width,height)){ 
  stop(); 
  } 

  c.onmouseout=function(e){ 
  start(); 
  } 

  c.onmousemove=function(e){ 
  if(InRectangle(e.clientX,e.clientY,left,top,width,height)){ 
  if(MyInterval!=null){ 
  stop(); 
  } 
  }else{ 
  start(); 
  } 
  } 

  } 
  &lt;/script&gt; 
  &lt;/body&gt; 
  &lt;/html&gt;
</code></pre>

<p>参考火狐html文档：<a href="https://developer.mozilla.org/en/HTML/HTML5" title="https://developer.mozilla.org/en/HTML/HTML5">https://developer.mozilla.org/en/HTML/HTML5</a></p>

<p>&nbsp;</p>

<p>&nbsp;&nbsp;&nbsp;&nbsp; 我的html5系列：</p>

<p>&nbsp;</p>

<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;本文通过程序<a href="https://github.com/greengerong/cnblogs-blogs2markdown" title="cnblogs-blogs2markdown">cnblogs-blogs2markdown</a>转换的,如质量有问题<a href="http://www.cnblogs.com/whitewolf/archive/2011/03/02/1968512.html" title="原文首发">原文首发请看这里</a></p>
>>>>>>> 0bab7647fe4f4f5795aed418af9d97aabf2983a0
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
<<<<<<< HEAD
      <h1 class="entry-title"><a href="/blog/2013/12/08/angualr-ie-select-do-not-render-when-option-change/">Angularjs位于ng-switch中的ng-option,当select option改变了在IE上不会重新渲染 Issue解决方案</a></h1>
=======
      <h1 class="entry-title"><a href="/blog/2011/02/26/win7-xia-cheng-xu-yun-hang-quan-xian-wen-ti-jie-jue-fang-an/">Win7下程序运行权限问题解决方案</a></h1>
>>>>>>> 0bab7647fe4f4f5795aed418af9d97aabf2983a0
    
    
      <p class="meta">
        








  


<<<<<<< HEAD
<time datetime="2013-12-08T00:00:00+08:00" pubdate data-updated="true"></time>
=======
<time datetime="2011-02-26T00:00:00+08:00" pubdate data-updated="true"></time>
        
           | <a href="/blog/2011/02/26/win7-xia-cheng-xu-yun-hang-quan-xian-wen-ti-jie-jue-fang-an/#disqus_thread"
             data-disqus-identifier="http://greengerong.github.io/blog/2011/02/26/win7-xia-cheng-xu-yun-hang-quan-xian-wen-ti-jie-jue-fang-an/">Comments</a>
>>>>>>> 0bab7647fe4f4f5795aed418af9d97aabf2983a0
        
      </p>
    
  </header>


<<<<<<< HEAD
  <div class="entry-content"><p>最近遇见angularjs 在IE上当使用ng-options作为select的选项数据源，并且被套在ng-switch（ng-transclude）之类的，当angular上得ng-options数据源model改变后，在IE上并不渲染。</p>

<p>在一阵的测试和阅读相关文档后最后确认为：因为ng-switch（ng-transclude）是为了使其scope为原来的父scope，在父scope上生成了DOM后才克隆(cloneNode)到指定的指令位置。然而IE在对于select克隆的节点，不会主动去触发重绘，所以才有了上面的issue。</p>

<p>问题确定了，那我们所需要做的就是手动的去触发让IE对Select重绘，尝试了很多办法后最终确认有效的是：首先在options上用原生js去添加一个option，在马上移除掉这个option，所以解决方案如下：</p>

<pre class='green'><code>angular.module('ie.select', [])
.directive('ieSelectFix', [
    function () {
        return {
            restrict: 'A',
            require: 'select',
            link: function (scope, element, attributes) {
                var isIE = document.attachEvent;
                if (!isIE) return;

                var control = element[0];
                scope.$watch(attributes.ieSelectFix, function () {
                    //it should be use javascript way, not jquery way.
                    var option = document.createElement("option");
                    control.add(option, null);
                    control.remove(control.options.length - 1);
                });
            }
        }
    }
]);
</code></pre>

<p>使用方式如下：</p>

<pre class='green'><code>&lt;select ie-select-fix="options" ng-model="demos" class="form-control"
        ng-options="currOption.value as currOption.text for currOption in options"&gt;
    &lt;option value="" default&gt;Select&lt;/option&gt;
&lt;/select&gt;
</code></pre>

<p>我也在我的github专门创建了一个针对angularjs在IE上issue的项目，收录了这个指令，在后续也会加入我所遇见的angularjs关于ie的issue，也希望大家帮助完善这个项目，让我们的angularjs程序在IE工作的更美好，让我们这些辛苦的程序猿也少一点加班时间，多一点陪家人，泡咖啡的时间。哈哈。</p>

<p>github项目地址：<a href="https://github.com/greengerong/angular-ie-enhancer">https://github.com/greengerong/angular-ie-enhancer</a></p>
=======
  <div class="entry-content"><p>&nbsp;&nbsp;&nbsp; 今天遇见一个win7下程序运行权限问题(需要对目录下文件有读写权限)：网上google下得到解决方案有,现记录下：</p>

<h2>一：</h2>

<p>&nbsp;&nbsp; windows 7和vista提高的系统的安全性，同时需要明确指定&#8220;以管理员身份运行&#8221;才可赋予被运行软件比较高级的权限，比如访问注册表等。否则，当以普通身份运行的程序需要访问较高级的系统资源时，将会抛出异常。</p>

<p>　　如何让程序在启动时，自动要求&#8220;管理员&#8221;权限了，我们只需要修改app.manifest文件中的配置项即可。</p>

<p>　　app.manifest文件默认是不存在的，我们可以通过以下操作来自动添加该文件。</p>

<p>（1）进入项目属性页。</p>

<p>（2）选择&#8220;安全性&#8221;栏目。</p>

<p>（3）将&#8220;启用ClickOnce安全设置&#8221;勾选上。</p>

<p>　　现在，在Properties目录下就自动生成了app.manifest文件，打开该文件，将trustInfo/security/requestedPrivileges节点的requestedExecutionLevel的level的值修改为requireAdministrator即可。如下所示：</p>

<div class="cnblogs_code" onclick="cnblogs_code_show('196faf80-6c73-421d-a3a0-d3e648f2ca9c')">
<div id="cnblogs_code_open_196faf80-6c73-421d-a3a0-d3e648f2ca9c">
<div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)

http://www.CodeHighlighter.com/

--><span style="color: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;</span><span style="color: #000000">requestedPrivileges&nbsp;xmlns</span><span style="color: #000000">=</span><span style="color: #800000">&#8221;</span><span style="color: #800000">urn:schemas-microsoft-com:asm.v3</span><span style="color: #800000">&#8221;</span><span style="color: #000000">&gt;</span><span style="color: #000000">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #000000">&lt;</span><span style="color: #000000">requestedExecutionLevel&nbsp;level</span><span style="color: #000000">=</span><span style="color: #800000">&#8221;</span><span style="color: red">**requireAdministrator**</span><span style="color: #800000">&#8221;</span><span style="color: #000000">&nbsp;uiAccess</span><span style="color: #000000">=</span><span style="color: #800000">&#8221;</span><span style="color: #800000">false</span><span style="color: #800000">&#8221;</span><span style="color: #000000">&nbsp;</span><span style="color: #000000">/&gt;</span><span style="color: #000000">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000000">&lt;/</span><span style="color: #000000">requestedPrivileges</span><span style="color: #000000">&gt;</span></div></div></div>


<p>&nbsp;</p>

<p>　　记住，如果不需要ClickOnce，可以回到项目属性页将&#8220;启用ClickOnce安全设置&#8221;不勾选。&nbsp;　　</p>

<p>　　接下来，重新编译你的程序就OK了。</p>

<p>&nbsp;</p>

<h2>二：</h2>

<p>&nbsp; 可以把文件的安装路径默认在非系统目录下，如d:\sorftwarename\等。或者酱程序和读写数据分开，读写数据文件放在我的文档下等，避开文件访问读写权限，避开program files目录。像google德Chrome就是文件直接默认（不能改动）安装在AppData下。</p>

<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;本文通过程序<a href="https://github.com/greengerong/cnblogs-blogs2markdown" title="cnblogs-blogs2markdown">cnblogs-blogs2markdown</a>转换的,如质量有问题<a href="http://www.cnblogs.com/whitewolf/archive/2011/02/26/1965824.html" title="原文首发">原文首发请看这里</a></p>
>>>>>>> 0bab7647fe4f4f5795aed418af9d97aabf2983a0
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/9/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/7/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>破 狼</h1>
  <p>    那一夜，我听了一宿梵唱，不为参悟，只为寻你的一丝气息。 那一月，我转过所有经轮，不为超度，只为触摸你的指纹。 那一年，我磕长头拥抱尘埃，不为朝佛，只为贴着了你的温暖。 那一世，我翻遍十万大山，不为修来世，只为路中能与你相遇。 那一瞬，我飞升成仙，不为长生，只为佑你平安喜乐。<a href="http://greengerong.github.io/blog/2009/12/24/cang-yang-jia-cuo-na-yi-tian-na-yi-yue-na-yi-nian-na-yi-shi/">《那一天，那一月，那一年，那一世》&#8211;仓央嘉措。</a></p>
</section>
<section>
  <p style="align: center"><a href="http://www.amazingcounters.com"><img border="0" src="http://cc.amazingcounters.com/counter.php?i=3158890&amp;c=9476983" alt="count web site visits"/></a></p>
<<<<<<< HEAD
</section>
<section>
    <h1>博客友情链接</h1>
    <ul>
        <li><a href="http://www.cnblogs.com/whitewolf/">博客园-破狼</a></li>
        <li><img src="http://greengerong.com/self/wei-xin-wolf-er-wei-ma.jpg" alt="破狼微信号订阅号" /></li>
    </ul>
=======
  <div style="display: none;">
    <script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fa24b16b917fd5e88f6d6dd10dc673619' type='text/javascript'%3E%3C/script%3E"));
</script>

  </div>
</section>
<section>
<h1>博客友情链接</h1>
  <ul>
    <li><a href="http://www.cnblogs.com/whitewolf/">博客园-破狼</a></li>
    <li><a href="http://whitewolfblog.blog.51cto.com/">51CTO&#8211;破狼</a></li>
  </ul>
>>>>>>> 0bab7647fe4f4f5795aed418af9d97aabf2983a0
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
<<<<<<< HEAD
        <a href="/blog/2016/01/30/zone-dot-js-bao-li-zhi-mei/">zone.js - 暴力之美</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/12/30/angularjsshen-du-pou-xi-yu-zui-jia-shi-jian-jian-jie/">《AngularJS深度剖析与最佳实践》简介</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/11/20/ni-ying-gai-zhi-dao-de-jqueryji-qiao/">(译)你应该知道的jQuery技巧</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/11/18/javascript-duo-xian-cheng-zhi-html5-web-worker/">JavaScript多线程之HTML5 Web Worker</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/11/11/angular-remove-unnecessary-watch-to-improve-performance/">Angular移除不必要的$watch之性能优化</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/10/27/javascript-single-thread-and-browser-event-loop/">JavaScript单线程和浏览器事件循环简述</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/10/22/promisede-miao-yong/">Promise的前世今生和妙用技巧</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/10/18/angular-wang-zhan-yong-hu-yin-dao-cha-jian/">自定义Angular插件 - 网站用户引导</a>
=======
        <a href="/blog/2014/02/28/nodejs-get-client-ip/">nodejs获取客户端IP Address</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/02/21/angular-form-addControl/">细说angular Form addControl方法</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/02/16/angularjs-chinese-guide-public/">Angularjs中文版本开发指南发布</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/02/15/index-for-ng-options/">为Angularjs ngOptions加上index解决方案</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/02/11/angular-ngclick-stoppropagation/">Angular ngClick阻止冒泡,默认行为</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/12/27/angular-ngcloak-new/">ngCloak 实现 Angular 初始化闪烁最佳实践</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/12/27/angular-ngcloak/">ngCloak 实现 Angular 初始化闪烁最佳实践</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/12/24/angular-controller-as-syntax-vs-scope/">Angular Controller as Syntax vs Scope</a>
>>>>>>> 0bab7647fe4f4f5795aed418af9d97aabf2983a0
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/greengerong">@greengerong</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'greengerong',
            count: 5,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
<<<<<<< HEAD
  Copyright &copy; 2016 - 破 狼 -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress
</a></span>
=======
  Copyright &copy; 2014 - 破 狼 -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
>>>>>>> 0bab7647fe4f4f5795aed418af9d97aabf2983a0
</p>

</footer>
  
<<<<<<< HEAD
 
 
=======

<script type="text/javascript">
      var disqus_shortname = 'greengerong';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>









>>>>>>> 0bab7647fe4f4f5795aed418af9d97aabf2983a0


</body>
</html>
